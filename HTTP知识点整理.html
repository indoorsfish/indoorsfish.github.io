<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"> 
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>HTTP知识点整理</title>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/style.css">
	
	<!-- HTML5 Shiv 和 Respond.js 用于让 IE8 支持 HTML5元素和媒体查询 -->
	<!-- 注意： 如果通过 file://  引入 Respond.js 文件，则该文件无法起效果 -->
      <!--[if lt IE 9]>
         <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
         <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
         <![endif]-->
	
     </head>
     <body>
     <header>
 		<nav class="navbar navbar-default navbar-inverse navbar-fixed-top" role="navgation">
 			<div class="container">
 				<div class="navbar-header">
 					<button type="button" class="navbar-toggle" data-toggle="collapse" 
	 					data-target="#example-navbar-collapse">
	 					<span class="sr-only">切换导航</span>
	 					<sapn class="icon-bar"></sapn>
	 					<span class="icon-bar"></span>
	 					<span class="icon-bar"></span>
	 				</button>
 					<span><a class="navbar-brand" href="index.html"> 朱厚强的Blog </a>
 						<i><img src="icon/logo.png" alt="logo"></i>
 					</span>
 		 	 	</div>
 				<div class="collapse navbar-collapse" id="example-navbar-collapse">
	 				<ul class="nav navbar-nav">
	 					<li><a href="index.html"><span class="glyphicon glyphicon-home" > 首页</span></a></li>
	 					<li><a href="index.html" class="html-btn">HTML</a></li>
	 					<li><a href="index.html" class="css-btn">CSS</a></li>
	 					<li><a href="index.html" class="javascript-btn jquery-btn">Js/JQuery</a></li>
	 					<li><a href="index.html" class="other-btn">其他</a></li>
	 					<li  class="dropdown" >
 						<a  href="#" class="dropdown-toggle" data-toggle="dropdown">
 							浏览器下载<span class="caret"></span> </a>
 							<ul class="dropdown-menu" role="menu">
 								<li class="dropdown-header">pc端</li>
 								<li role="presentation"><a rel="nofollow" href="https://support.microsoft.com/zh-cn/help/17621/internet-explorer-downloads">IE11</a></li>
 								<li role="presentation"><a rel="nofollow" href="http://www.google.cn/chrome/browser/desktop/">Chrome</a></li>
 								<li role="presentation"><a rel="nofollow" href="http://www.firefox.com.cn/">Firefox</a></li>
 								<li role="presentation" class="divider"></li>
 								<li role="presentation" class="dropdown-header">移动端</li>
 								<li role="presentation"><a rel="nofollow" href="https://support.apple.com/zh_CN/downloads/safari">Safary</a></li>
 								<li role="presentation"><a rel="nofollow" href="http://www.opera.com/zh-cn">Opera</a></li>
 							</ul>
 						</li>
 						<li><a href="留言板.html">留言板</a></li>
 					</ul>    
 				</div>
 			</div>    
 		</nav>
 	</header>
 	<!-- 灯开关 -->
 <div class="deng"  title="白天模式/夜间模式">
      <input type="checkbox" id="deng" />
      <label class="slider-v1" for="deng"></label>
  </div>

  <!--    主体 -->
     	<div class="main container">
			<div class="Breadcrumbs">
				<ol class="breadcrumb">
			  	 	<li><a href="#">首页</a></li>
			  	 	<li><a href="blog-all.html">全部</a></li>
			   		<li><a href="blog-all.html">其他</a></li>
			  		<li>HTTP知识点整理</li>
				</ol>
			</div>

			<div class="row">
			<div class="article col-sm-9">
				<div class="page-header">
					<h1>HTTP知识点整理</h1>
					<p class="posted-date text-muted">
 						<span class="glyphicon glyphicon-time"></span> 2018年1月31日</p> 
				</div>
				<div class="detail-article">
				<h3>引：</h3>
				<p>HTTP 协议（超文本传输协议，HyperText Transfer Protocol)是互联网的基础协议，它是基于 TCP/IP 协议(传输层协议)的<strong>应用层协议</strong>，是一种互联网的基础协议。HTTP 协议不涉及数据包传输，主要规定了客户端和服务器之间的通信格式，默认使用80端口，是一种请求/响应式的协议，客户端与服务器建立连接后，发送一个请求给服务器，服务器接到请求后，给予相应的响应信息。</p>
				<h2>HTTP/1.0</h2>
				<p>HTTP/1.0算是较老的协议标准了，为了提高系统的效率，HTTP 1.0规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求，是一种标准的无状态协议。</p>
				<h3>请求格式</h3>
				<p>下面是一个1.0版的HTTP请求的例子。可以看到，第一行是请求命令，必须在尾部添加协议版本（HTTP/1.0）。后面就是多行头信息，描述客户端的情况。</p>
				<pre>GET / HTTP/1.0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5)
Accept: */*</pre>
				<h3>响应格式</h3>
				<p>服务器响应如下，响应的格式是"头信息 + 一个空行（\r\n） + 数据"。其中，第一行是"协议版本 + 状态码（status code） + 状态描述"。</p>
				<pre>HTTP/1.0 200 OK 
Content-Type: text/plain
Content-Length: 137582
Expires: Thu, 05 Dec 1997 16:00:00 GMT
Last-Modified: Wed, 5 August 1996 15:55:28 GMT
Server: Apache 0.84

&lt;html&gt;
  ...
&lt;/html&gt;</pre>
				<h3>缺点</h3>
				<p>HTTP/1.0 版的主要缺点是，每个TCP连接只能发送一个请求。发送数据完毕，连接就关闭，如果还要请求其他资源，就必须再新建一个连接。</p>
				<p>TCP连接的新建成本很高，因为需要客户端和服务器三次握手，并且开始时发送速率较慢（slow start）。所以，HTTP 1.0版本的性能比较差。随着网页加载的外部资源越来越多，这个问题就愈发突出了。</p>
				<p>为了解决这个问题，有些浏览器在请求时，用了一个非标准的Connection字段。</p>
				<pre>Connection: keep-alive</pre>
				<p>这个字段要求服务器不要关闭TCP连接，以便其他请求复用。服务器同样回应这个字段</p>
				<pre>Connection: keep-alive</pre>
				<p>一个可以复用的TCP连接就建立了，直到客户端或服务器主动关闭连接。但是，这不是标准字段，不同实现的行为可能不一致，因此不是根本的解决办法。</p>
				<br>
				<h2>HTTP/1.1</h2>
				<h3>请求消息结构</h3>
				<p>客户端发送的请求消息由请求行、请求头字段、一个空行和消息主体构成。</p>
				<h4>请求行</h4>
				<p>请求消息的第一行就是请求行。它指明使用的请求方法、资源标示符、和 HTTP 版本。如：</p>
				<pre>GET /demo.htm HTTP/1.1</pre>
				<h4>请求方法</h4>
				<p>请求方法用来定义操作资源的方式，HTTP/1.1 协议中定义了八种请求方法：</p>
				<ul>
					<li>GET：读取资源数据;</li>
					<li>POST：新建资源数据;</li>
					<li>PUT：更新资源数据;</li>
					<li>DELETE：删除资源数据;</li>
					<li>HEAD：读取资源的元数据;</li>
					<li>OPTIONS：读取该资源所支持的所有请求方法;</li>
					<li>TRACE：回显服务器收到的请求，主要用于测试或诊断;</li>
					<li>CONNECT：HTTP/1.1 协议中预留给能够将连接改为管道方式的代理服务器。通常用于SSL加密服务器的链接.</li>
				</ul>
				<h4>请求头字段</h4>
				<ul>
					<li>Cache-Control：客户端希望服务端如何缓存自己的请求数据，如”Cache-Control: no-cache”，”Cache-Control: max-age=0”；</li>
					<li>Connection：客户端是否希望与服务端之间保持长连接，如”Connection: close”, “Connection: keep-alive”；</li>
					<li>Date：只有当请求方法为POST或PUT方法时客户端才可能会有些字段；</li>
					<li>Pragma：包含了客户端一些特殊请求信息，如 “Pragma: no-cache”, 客户端希望代理或应用服务器不应缓存与该请求相关的结果数据；</li>
					<li>Accept： 表明客户端可接受的请求回应的媒体类型范围列表,如：如 Accept: text/html;</li>
					<li>Accept-Charset：客户端所能识别的字符集编码格式；</li>
					<li>Accept-Language：客户端所能识别的语言；</li>
					<li>Host：客户请求的主机域名或主机IP；</li>
					<li>User-Agent：表明用户所使用的浏览器标识，主要用于统计的目的；</li>
					<li>Referer：指明该请求是从哪个页面连接过来的;</li>
					<li>Accept-Encoding：客户端所能识别的编码压缩格式，如：”Accept-Encoding: gzip, deflate”；</li>
					<li>If- Modified-Since：该字段与客户端缓存相关，客户端所访问的URL自该指定日期以来在服务端是否被修改过，如果修改过则服务端返回新的修改后 的信息，如果未修改过则服务器返回304表明此请求所指URL未曾修改过；</li>
					<li>If-None-Match：该字段与客户端缓存相关，客户端发送URL请求的同时发送该字段及标识，如 果服务端的标识与客户端的标识一致，则返回304表明此URL未修改过，如果不一致则服务端返回完整的数据信息;</li>
					<li>Cookie：为扩展字段，存储于客户端，向同一域名的服务端发送属于该域的cookie；</li>
					<li>Content-Encoding：客户端所能识别的编码压缩格式，如：Content-Encoding: gzip, deflate；</li>
					<li>Content-Length：客户端以POST方法上传数据时数据体部分的内容长度，如：Content-Length: 24；</li>
					<li>Content- Type：客户端发送的数据体的内容类型，如：Content-Type: application/x-www-form-urlencoded为以普通的POST方法发送的数据；</li>
				</ul>
				<h4>空行</h4>
				<p>指示头字段区完成，消息主体开始（如果有消息主体的话）。</p>
				<h4>消息主体</h4>
				<p>消息主体是请求消息的承载数据。比如在提交POST表单，并且表单方法不是GET时，表单数据就是打包在消息主体内的。消息主体是可选的。</p>
				<h3>响应消息结构</h3>
				<h4>状态行</h4>
				<p>由http版本、状态码、状态描述文字构成。如</p>
				<pre>HTTP/1.1 200 OK</pre>
				<h4>状态码</h4>
				<p>HTTP 状态码是用以表示网页服务器 HTTP 响应状态的3位数字代码。 所有的状态码的第一个数字代表了响应的五种状态之一:</p>
				<ul>
				<li>1xx：代表请求已被接受，需要继续处理。这类响应是临时响应，只包含状态行和某些可选的响应头信息，并以空行结束；</li>
				<li>2xx：代表请求已成功被服务器接收、理解、并接受；</li>
				<li>3xx：代表需要客户端采取进一步的操作才能完成请求。通常，这些状态码用来重定向，后续的请求地址（重定向目标）在本次响应的Location域中指明；</li>
				<li>4xx：代表了客户端看起来可能发生了错误，妨碍了服务器的处理。</li>
				<li>5xx：代表了服务器在处理请求的过程中有错误或者异常状态发生，也有可能是服务器意识到以当前的软硬件资源 无法完成对请求的处理。</li>
				</ul>
				<h3>响应头字段</h3>

				<ul>
				<li>Cache- Control：服务端要求中间代理及客户端如何缓存自己响应的数据，如”Cache-Control: no-cache”，如：”Cache-Control: private”不希望被缓存，”Cache-Control: public” 可以被缓存；</li>
				<li>Connection：服务端是否希望与客户端之间保持长连接； <br>
				Date：只有当请求方法为POST或PUT方法时客户端才可能会有些字段；</li>
				<li>Pragma：包含了服务端一些特殊响应信息，如”Pragma: no-cache”服务端希望代理或客户端不应缓存结果数据；</li>
				<li>Transfer-Encoding：服务端向客户端传输数据所采用的传输模式(仅在HTTP1.1中出现)；</li>
				<li>Accept-Ranges：表明服务端接收的数据单位，如：Accept-Ranges: bytes；</li>
				<li>Location：服务端向客户端返回此信息以使客户端进行<strong>重定向</strong>；</li>
				<li>Server：服务器的名称;</li>
				<li>ETag：服务端返回的响应数据的标识字段，客户端可根据此字段的值向服务器发送某URL是否更新的信息；</li>
				<li>Content-Encoding：服务端响应数据的编码格式，如：”Content-Encoding: gzip”；</li>
				<li>Content-Length：服务端返回数据的数据体部分的内容长度，如：”Content-Length: 24”；</li>
				<li>Content-Type：服务端返回的数据体的内容类型，如：”Content-Type: text/html; charset=utf-8”；</li>
				<li>Set-Cookie：服务端返回给客户端的cookie数据;</li>
				</ul>
				<h3>持久连接</h3>
				<p>HTTP1.1 版的最大变化，就是引入了持久连接，即TCP连接默认不关闭，可以被多个请求复用，不用声明Connection: keep-alive。 
				客户端和服务器发现对方一段时间没有活动，就可以主动关闭连接。不过，规范的做法是，客户端在最后一个请求时，发送Connection: close，明确要求服务器关闭TCP连接。</p>
				<pre>Connection: close</pre>
				<p>目前，对于同一个域名，大多数浏览器允许同时建立6个持久连接</p>
				<h3>管道机制</h3>
				<p>HTTP1.1 版还引入了管道机制，即在同一个TCP连接里面，客户端可以同时发送多个请求。这样就进一步改进了HTTP协议的效率。<strong>管道机制规则：</strong>允许浏览器同时发出A请求和B请求，但是服务器还是按照顺序，先回应A请求，完成后再回应B请求。举例来说：客户端需要请求两个资源。以前的做法是，在同一个TCP连接里面，先发送A请求，然后等待服务器做出回应，收到后再发出B请求。</p>
				<h3>Content-Length 字段</h3>
				<p>一个TCP连接现在可以传送多个回应，势必就要有一种机制，区分数据包是属于哪一个回应的。这就是Content-length字段的作用，声明本次回应的数据长度。</p>
				<h3>分块传输编码</h3>
				<p>使用Content-Length字段的前提条件是，服务器发送回应之前，必须知道回应的数据长度。 
				对于一些很耗时的动态操作来说，这意味着，服务器要等到所有操作完成，才能发送数据，显然这样的效率不高。更好的处理方法是，产生一块数据，就发送一块，采用”流模式”（stream）取代”缓存模式”（buffer）。</p>
				<p>因此，1.1版规定可以不使用Content-Length字段，而使用”分块传输编码”。只要请求或回应的头信息有Transfer-Encoding字段，就表明回应将由数量未定的数据块组成。</p>
				<pre>Transfer-Encoding: chunked</pre>
				<h3>其他功能</h3>
				<p>1.1版还新增了许多动词方法：PUT、PATCH、HEAD、 OPTIONS、DELETE。
				另外，客户端请求的头信息新增了Host字段，用来指定服务器的域名，Host字段可以将请求发往同一台服务器上的不同网站。</p>
				<pre>Host: www.example.com</pre>
				<h3>缺点</h3>
				<p>虽然1.1版允许复用TCP连接，但是同一个TCP连接里面，所有的数据通信是按次序进行的。服务器只有处理完一个回应，才会进行下一个回应。要是前面的回应特别慢，后面就会有许多请求排队等着。这称为”队头堵塞”。 
				为了避免这个问题，只有两种方法：一是减少请求数，二是同时多开持久连接。这导致了很多的网页优化技巧，比如合并脚本和样式表、将图片嵌入CSS代码、域名分片等等。如果HTTP协议设计得更好一些，这些额外的工作是可以避免的。</p>
				<br>
				<h2>*SPDY 协议</h2>
				<p>2009年，谷歌公开了自行研发的 SPDY 协议，主要解决 HTTP/1.1 效率不高的问题。这个协议在Chrome浏览器上证明可行以后，就被当作 HTTP/2 的基础，主要特性都在 HTTP/2 之中得到继承。</p>
				<br>
				<h2>HTTP/2</h2>
				<h3>二进制协议</h3>
				<p>HTTP/1.1 版的头信息肯定是文本（ASCII编码），数据体可以是文本，也可以是二进制。<strong>HTTP/2 则是一个彻底的二进制协议</strong>，头信息和数据体都是二进制，并且统称为”帧”（frame）：头信息帧和数据帧。</p>
				<h3>多工</h3>
				<p>HTTP/2 复用TCP连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，而且不用按照顺序一一对应，这样就避免了”队头堵塞”。 举例来说，在一个TCP连接里面，服务器同时收到了A请求和B请求，于是先回应A请求，结果发现处理过程非常耗时，于是就发送A请求已经处理好的部分，接着回应B请求，完成后，再发送A请求剩下的部分。这样双向的、实时的通信，就叫做多工（Multiplexing）。</p>
				<h3>数据流</h3>
				<p>
				HTTP/2 将每个请求或回应的所有数据包，称为一个数据流。每个数据流都有一个独一无二的编号。数据包发送的时候，都必须标记数据流ID，用来区分它属于哪个数据流。另外还规定，客户端发出的数据流，ID一律为奇数，服务器发出的，ID为偶数。
				数据流发送到一半的时候，客户端和服务器都可以发送信号（RST_STREAM帧），取消这个数据流。1.1版取消数据流的唯一方法，就是关闭TCP连接。这就是说，HTTP/2 可以取消某一次请求，同时保证TCP连接还打开着，可以被其他请求使用。 </p>
				<p>客户端还可以指定数据流的优先级。优先级越高，服务器就会越早回应。</p>
				<h3>头信息压缩</h3>
				<p>HTTP 协议不带有状态，每次请求都必须附上所有信息。所以，请求的很多字段都是重复的，比如Cookie和User Agent，一模一样的内容，每次请求都必须附带，这会浪费很多带宽，也影响速度。 </p>
				<p>HTTP/2 对这一点做了优化，引入了头信息压缩机制（header compression）。一方面，头信息使用gzip或compress压缩后再发送；另一方面，客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。</p>
				<h3>服务器推送</h3>
				<p>HTTP/2 允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送（server push）。 </p>
				<p>常见场景是客户端请求一个网页，这个网页里面包含很多静态资源。正常情况下，客户端必须收到网页后，解析HTML源码，发现有静态资源，再发出静态资源请求。其实，服务器可以预期到客户端请求网页后，很可能会再请求静态资源，所以就主动把这些静态资源随着网页一起发给客户端了。</p>
				<p></p>

				<hr>
					<p></p>
				<p>标签：
					<button class="btn btn-primary btn-xs"><a href="">其他</a> </button></p>	
					 <div class="share">
						<div class="good"><span class="glyphicon glyphicon-thumbs-up"></span><br><span>2</span>
						</div>	
					 </div>
					<div class="talk">
					 	<h2>评论：</h2>
					 	<hr>
					 	<form action="#"  class="form-horizontal" role="form">
					 		<div class="form-group">
 								<label for="name" class="col-sm-2 control-label">昵称</label>
 								<div class="col-sm-10">
 									<input type="text" class="form-control"  id="fname" placeholder="请输入昵称">
 								</div>
 							</div>
 							<div class="form-group">
 								<label for="content" class="col-sm-2 control-label" >留言内容</label>
 								<div class="col-sm-10">
 									<textarea name="content" id="fcontent"  class="form-control" placeholder="保持140个字符内"></textarea>
 								</div>
 							</div>
 							<div class="form-group">
 								<div class="col-sm-offset-2 col-sm-10">
 									<button type="submit" class="btn btn-default submit">提交</button>
 								</div>
 							</div>
					 	</form>
					 </div>
				</div>

	  		</div>	
			<!-- 侧边栏 -->
				<aside class="container col-sm-3">
					<div class="intro">
						<div class="head-icon"><img src="icon/head-icon.jpg"  class="img-circle"  		alt="我的头像">
							<h3>朱厚强<br></h3>
							<em>一名兴趣使然的Web Designer</em>
						</div><br>
						<div class="contact">
							<ul>
								<li><a href="weixin.html" target="_blank"  class="contact-1" ></a></li>
								<li><a href="http://wpa.qq.com/msgrd?v=3&uin=245773708&site=qq&menu=yes" title="qq：245773708" class="contact-2"></a></li>
								<li><a href="#" title="微博账号被封" class="contact-3"></a></li>
								<li><a href="https://github.com/indoorsfish" target="_blank" title="github" class="contact-4" ></a></li>
							</ul>
						</div>
					</div>
					<div class="weixin"><img src="images/wx.png" alt="weixins.png"></div>
						<div class="tab">
							<p class="lead">站内搜索&nbsp;<span class="glyphicon glyphicon-search" style="font-size: 14px;"></span></p>
							<form action="blog-all.html" role="form">
								<div class="form-group input-group">	
									<input type="text"  class ="form-control" placeholder="search...">
									<span class="input-group-btn">
	                      			  <button class="btn btn-primary" type="button">搜索</button>
	                    			</span>
								</div>
							</form>
						</div>
						<div class="tab"> 
							<p class="lead">标签分类&nbsp;<span class="glyphicon glyphicon-tags" style="font-size: 14px;"></span></p>
							<div class="summary"> 
								<button class="btn btn-primary btn-xs"><a href="blog-all.html">全部</a><span class="badge"></span></button>
								<button class="btn btn-success btn-xs html-btn"><a href="blog-all.html" >HTML</a><span class="badge"></span> </button>
								<button class="btn btn-info btn-xs css-btn"><a href="blog-all.html" >CSS</a><span class="badge"></span> </button>
								<button class="btn btn-warning btn-xs javascript-btn"><a href="blog-all.html" class="">JavaScript</a><span class="badge"></span></button> 
								<button class="btn btn-danger btn-xs jquery-btn"><a href="blog-all.html" >JQuery</a><span class="badge"></span></button>
								<button class="btn btn-primary btn-xs other-btn"><a href="blog-all.html">其他</a> </button>
							</div>
						</div>
						<div class="tab">
						  <p class="lead">日历&nbsp;<span class="glyphicon glyphicon-calendar" style="font-size: 14px;"></span></p>
						<div id="calendar">
						<a href="##" class="lastMonth"><</a> 
						<a href="##" class="nextMonth">></a>
						<h4>2013年10月</h4>
						<ul class="week">
							<li>日</li>
							<li>一</li>
							<li>二</li>
							<li>三</li>
							<li>四</li>
							<li>五</li>
							<li>六</li>
						</ul>
						<ul class="dateList"></ul>
						</div>
					 </div>
				</aside>
				</div>
			</div>

			<footer class="foot">
				<p>Copyright© 2018 朱厚强的博客</p>
			</footer>
			<div id="board">  
				<p id="goTop"><span class="glyphicon glyphicon-chevron-up"></span></p> 
				<p id="mb"><a href="留言板.html" title="留言版"><span class="glyphicon glyphicon-envelope"></span></a></p> 
			</div>  



     <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
     <script src="http://cdn.bootcss.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
     <script type="text/javascript" src="javascript/act.js"></script>
 </body>
 </html>
